{"dependencies":[{"name":"/home/akiohayakawa/workspace/browser_editor/package.json","includedInParent":true,"mtime":1532065308636},{"name":"vueify/lib/insert-css","loc":{"line":1,"column":39}},{"name":"babel-runtime/core-js/array/from","loc":{"line":9,"column":20}},{"name":"./../../editor/editorContextMenu","loc":{"line":13,"column":33}},{"name":"./../../editor/clipboard","loc":{"line":17,"column":25}},{"name":"./../../EditorUtils","loc":{"line":21,"column":27}},{"name":"./../../currentGraph","loc":{"line":25,"column":28}},{"name":"./../../editor/SDNLayer","loc":{"line":29,"column":24}},{"name":"./../../editor/SDNLink","loc":{"line":33,"column":23}},{"name":"./../../misc/Definitions","loc":{"line":37,"column":27}},{"name":"vue/dist/vue.esm.js","loc":{"line":41,"column":22}}],"generated":{"js":"var e=require(\"vueify/lib/insert-css\").insert(\".network-tabs{width:100%;height:40px;border-bottom:solid 1px var(--color-gray2)}.graphs-tab{float:left;height:39px;line-height:39px;padding-right:8px}.graphs-tab.active{box-sizing:border-box;border-bottom:solid 2px var(--color-brand)}.graphs-tab.active>span>.graph-name{color:var(--color-brand)}.graphs-tab:hover{background-color:var(--color-gray1)}.graph-name{margin-left:24px;margin-right:12px;font-size:13px;color:var(--color-gray5);line-height:40px}.graph-addnew-img,.graph-remove-img{width:16px;height:16px;margin:8px 0;vertical-align:middle}.graph-add{padding-left:8px}#network-editor{display:block}.layer-properties-scroller,.network-editor-scroller,.network-statistics-scroller{overflow:auto;width:100%}.stat-line{height:25px;line-height:24px;vertical-align:baseline}.stat-line.active{background-color:var(--color-gray2)}.stat-line>.content{margin-left:16px;margin-right:16px;border-bottom-color:var(--color-gray4);border-bottom-width:1px;border-bottom-style:solid}.stat-line>.content>.name{color:var(--color-gray4);float:left;width:120px}\");!function(){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=l(require(\"babel-runtime/core-js/array/from\")),t=l(require(\"./../../editor/editorContextMenu\")),n=l(require(\"./../../editor/clipboard\")),r=l(require(\"./../../EditorUtils\")),o=l(require(\"./../../currentGraph\")),a=l(require(\"./../../editor/SDNLayer\")),i=l(require(\"./../../editor/SDNLink\")),u=l(require(\"./../../misc/Definitions\")),s=l(require(\"vue/dist/vue.esm.js\"));function l(e){return e&&e.__esModule?e:{default:e}}window.Network;var c={graphs:[{name:\"Main\",nodes:[],links:[]}],target:\"Main\"},d=function(){return c.graphs.map(function(e){return e.name})},f=function(e){return d().indexOf(e)},p=function(e){var t=c.graphs;t.splice(t.length,0,{name:e,nodes:[],links:[]})},m=function(e){var t=c.graphs,n=f(e),r=t[n];return t.splice(n,1),0===t.length&&p(\"Main\"),{index:n,deleted:r,\"next-target\":e===c.target?t[0].name:c.target}},g=function(e){h(),o.default.clear(),c.target=e,v(e)},h=function(){var e=c.graphs[f(c.target)];return e&&(s.default.set(e,\"nodes\",o.default.layers(function(e){return e.serialize()})),s.default.set(e,\"links\",o.default.links(function(e){return e.serialize()}))),e},v=function(e){var t=c.graphs[f(e)];if(t){s.default.set(c,\"target\",t.name);var n=t.nodes.map(a.default.deserialize);window.nnc.components.Editor.initPropMap(n),t.links.forEach(i.default.deserialize)}},y=/^([^|]+)\\|([^|]+)\\|([^|]+)\\|.*:\\s(.*)$/;window.Graphs={data:function(){return c.graphs},reset:function(e){return function(e){Array.isArray(e)&&0!==e.length||(e=[{name:\"Main\",nodes:[],links:[]}]),c.graphs=e,o.default.clear(),v(e[0].name)}(e)},flush:function(){return h()},feed:function(e,t){if(e===c.target){window.nnc.components.Editor.onComputedProperties(t.nodes);var n={};t.nodes.forEach(function(e){return n[e.name]=e.properties}),o.default.layers(function(e){return e.setProperties(n[e.name()])})}},stat:function(t,n){var r=function(e,t){return n[\"Statistics_\"+e+\"_\"+t]};window.nnc.components.Editor.updateStatistics((0,e.default)({length:n.NumStatistics}).map(function(e,t){return{name:r(t,\"Name\"),max:r(t,\"Max\"),sum:r(t,\"Sum\")}}))},error:function(e){var t=c.target,n=e.split(\"\\n\").map(function(e){return y.exec(e)}).filter(function(e){return e}).map(function(e){return{graph:e[1],layer:e[2],property:e[3],message:e[4]}}).filter(function(e){return e.graph===t});window.nnc.components.Editor.onComputedErrors(n),o.default.layers(function(e){var t=e.name();e.setErrorProperties(n.filter(function(e){return e.layer===t}))})},arrange:function(e,t){if(e===c.target){var n={};o.default.layers(function(e){var r=e.name(),o=t.nodes.find(function(e){return e.name===r});o&&(n[r]={fore:{x:o.x,y:o.y},back:e.getPosition()})});var r=function(e){return function(t){var r=(n[t.name()]||{})[e];r&&t.setPosition(r)}};window.nnc.components.Editor.history.execute({type:\"push-and-execute\",argument:{name:function(){return\"Arrange Layers\"},exec:function(){return o.default.layers(r(\"fore\"))},undo:function(){return o.default.layers(r(\"back\"))}}})}}},window.uop=r.default.allowedUserOperation;var k=function(){return window.svgArea.draggingLayer()};exports.default={props:{selectedComponent:String,selection:Object,historyInfo:Object,networkGraph:Object},data:function(){return{layerTextClipId:u.default.EDIT.LAYER.CLIP_PATH.ID,layerTextClipWidth:u.default.EDIT.LAYER.CLIP_PATH.WIDTH,layerTextClipHeight:u.default.EDIT.LAYER.CLIP_PATH.HEIGHT}},components:{\"network-tabs\":{template:'\\n                <div class=\"network-tabs\">\\n                    <graph-tab v-for=\"graph in graphs\"\\n                        v-bind:graph=\"graph\"\\n                        :key=\"graph.name\"\\n                        :class=\"{\\'active\\': graph.name===target}\"\\n                        @history=\"command => $emit(\\'history\\', command)\"\\n                    />\\n                    <graph-tab-append\\n                        @history=\"command => $emit(\\'history\\', command)\"\\n                    />\\n                </div>\\n            ',data:function(){return c},components:{\"graph-tab\":{props:[\"graph\"],template:'\\n                        <div class=\"graphs-tab nnc-invoker\" @click=\"clicked(graph.name);\">\\n                            <div v-if=\"graph.renaming\">\\n                                <input\\n                                    type=\"text\"\\n                                    size=\"20\"\\n                                    v-focus\\n                                    v-bind:value=\"graph.name\"\\n                                    @keydown=\"keydown\"\\n                                    @blur=\"lostEditFocus($event, graph.name);\" />\\n                            </div>\\n                            <span v-else>\\n                                <span class=\"graph-name\">{{ graph.name }}</span>\\n                                <span>\\n                                    <span class=\"delete-mark\" @click.stop.prevent=\"clickedDelete(graph.name);\">\\n                                        <img class=\"graph-remove-img\" src=\"./editor/image/Remove.svg\"/>\\n                                    </span>\\n                                </span>\\n                            </span>\\n                        </div>\\n                    ',methods:{startEdit:function(e){s.default.set(c.graphs[f(e)],\"renaming\",!0)},selectTarget:function(e){var t=function(){var t=c.target;g(e),e=t};this.$emit(\"history\",{type:\"push-and-execute\",argument:{exec:t,undo:t,name:function(){return\"Change active network\"}}})},clicked:function(e){c.target===e?this.startEdit(e):this.selectTarget(e)},clickedDelete:function(e){var t=void 0;this.$emit(\"history\",{type:\"push-and-execute\",argument:{exec:function(){t=m(e),g(t[\"next-target\"])},undo:function(){var e=c.graphs;e.splice(t.index,0,t.deleted),g(e[t.index].name)},name:function(){return\"Delete network\"}}})},lostEditFocus:function(e,t){var n=c.graphs[f(t)];s.default.delete(n,\"renaming\"),this.renameTarget(n,e.target.value)},renameTarget:function(e,t){if(t&&d().every(function(e){return e!==t})){var n=c.target;this.$emit(\"history\",{type:\"push-and-execute\",argument:{exec:function(){s.default.set(e,\"name\",t),s.default.set(c,\"target\",t)},undo:function(){s.default.set(e,\"name\",n),s.default.set(c,\"target\",n)},name:function(){return\"Change network name\"}}})}},keydown:function(e){switch(e.keyCode){case 27:case 13:e.target.blur()}}},directives:{focus:{inserted:function(e){e.focus(),e.select()}}}},\"graph-tab-append\":{template:'<div class=\"graphs-tab graph-add\" @click=\"clickedAddNetworkGraph\"><img class=\"graph-addnew-img\" src=\"./editor/image/AddNew.svg\"/></div>',methods:{clickedAddNetworkGraph:function(){var e=\"Network_\"+d().filter(function(e){return 0===e.indexOf(\"Network_\")}).map(function(e){return Number(e.replace(\"Network_\",\"\"))}).filter(function(e){return!isNaN(e)&&e>1}).sort(function(e,t){return e-t}).reduce(function(e,t){return e+(e===t)},2),t=c.target;this.$emit(\"history\",{type:\"push-and-execute\",argument:{exec:function(){p(e),g(e)},undo:function(){m(e),g(t)},name:function(){return\"Add network\"}}})}}}}},\"network-action\":{props:{selection:Object,historyInfo:Object,zoomPercantages:Array,zoomCurrentPercentage:Number},template:'\\n                <div class=\"network-action\">\\n                    <tool-button image-name=\"Undo\"  :disabled=\"!historyInfo.undo.enabled\" @pressed=\"$emit(\\'history\\', {type: \\'undo\\'})\" />\\n                    <tool-button image-name=\"Redo\"  :disabled=\"!historyInfo.redo.enabled\" @pressed=\"$emit(\\'history\\', {type: \\'redo\\'})\" />\\n                    <tool-button image-name=\"Cut\"   :disabled=\"!selection.all.length\"     @pressed=\"cut\" />\\n                    <tool-button image-name=\"Copy\"  :disabled=\"!selection.all.length\"     @pressed=\"copy\" />\\n                    <tool-button image-name=\"Paste\" :disabled=\"false\"                     @pressed=\"paste\" />\\n                    <div class=\"pull-right\">\\n                        <nnc-zoom-box :percentages=\"zoomPercantages\" :percentage=\"zoomCurrentPercentage\" @zoom-value=\"value => $emit(\\'zoom\\', {name: \\'Editor\\', percentage: value})\" />\\n                        <button @click=\"dropDownMenu\" class=\"btn network-action-button\" data-toggle=\"dropdown\">\\n                            Action&nbsp;\\n                            <span class=\"caret\" />\\n                        </button>\\n                        <div class=\"action-menu-item dropdown-menu\" />\\n                    </div>\\n                </div>\\n            ',components:{\"tool-button\":{props:{imageName:String,disabled:Boolean},template:'\\n                        <img v-if=\"disabled\" :src=\"\\'./editor/image/\\' + imageName + \\'.svg\\'\" class=\"network-action-image nnc-disabled\" />\\n                        <img v-else          :src=\"\\'./editor/image/\\' + imageName + \\'.svg\\'\" class=\"network-action-image nnc-enabled nnc-invoker\" @click.stop.prevent=\"$emit(\\'pressed\\')\" />\\n                    '}},data:function(){return c},methods:{cut:function(){return n.default.cut()},copy:function(){return n.default.copy()},paste:function(){return n.default.paste()},dropDownMenu:function(){$(\".network-context-menu.context-menu\").remove(),$(\".action-menu-item\").children().remove(),$(\".action-menu-item\").append(t.default.createContextMenu)}}}},computed:{values:function(){return r.default.indexOperator(this.networkGraph.percentages,this.networkGraph.percentage)}},methods:{deleteLayerKeepingLinks:function(){if(window.uop()&&!k()&&0<o.default.selection.layer.members().length){var e=function(e){return e?e.links():[]},t=function(e){return e.serialize()},n=o.default.selection.layer.focused(),r={layer:n.serialize(),links:n.allLinks().map(t)},u=function(e){return e.isDefault()},s=e(n.getInConnector()).map(function(e){return e.source()}).filter(u),l=e(n.getOutConnector()).map(function(e){return e.destination()}).filter(u);n.remove();var c=void 0;if(s.length){var d=s[0];c=l.map(function(e){try{return d.linkTo(e)}catch(e){return null}}).filter(Boolean)}else c=[];var f={links:c.map(t)},p=function(e){return e.forEach(i.default.deserialize)},m=function(e){return e.map(i.default.findObjectBySerialized).filter(function(e){return e}).forEach(function(e){return e.remove()})};this.$emit(\"history\",{type:\"push\",argument:{name:function(){return\"Delete\"},exec:function(){var e;m(r.links),e=r.layer,(a.default.findObjectBySerialized(e)||{remove:function(){}}).remove(),p(f.links)},undo:function(){var e;m(f.links),e=r.layer,a.default.deserialize(e),p(r.links)}}})}},deleteLayer:function(){window.uop()&&!k()&&o.default.deleteSelection(\"Delete\")},addLayer:function(){var e=this.selectedComponent;e&&window.svgArea.addLayer(e)},insertLayer:function(){var e,t=this.selectedComponent;if(window.uop()&&t&&o.default.selection.layer.focused()){var n=function(e){return o.default.layers().find(function(t){return t.name()==e})},r=u.default.EDIT.LAYER.RECT_HEIGHT,s=o.default.selection.layer.focused(),l=s.getPosition(),c=function(e){return{x:e.x,y:e.y+r}},d=o.default.layers(function(e){var t=e.getPosition();return l.y<=t.y?(e.setPosition(c(t)),{name:e.name(),position:t}):null}).filter(function(e){return e}),f=(s.getInConnector()||{links:function(){return[]}}).links(),p=f.map(function(e){return e.source()}),m=f.map(function(e){return e.serialize()});f.forEach(function(e){return e.remove()});var g=new a.default({type:t,x:l.x,y:l.y},window.svgArea),h=g.getInConnector(),v=g.getOutConnector(),y=void 0;if(h){y=(e=p,1===h.linkingLimit()?e.splice(e.length-1,1):e).map(function(e){return e.linkTo(h)}).map(function(e){return e.serialize()})}else y=[];if(v&&(f.length>0||s.getInConnector())){var k=v.linkTo(s.getInConnector());y.push(k.serialize())}var b=g.serialize();this.$emit(\"history\",{type:\"push\",argument:{exec:function(){d.forEach(function(e){return n(e.name).setPosition(c(e.position))}),m.map(i.default.findObjectBySerialized).forEach(function(e){return e.remove()}),a.default.deserialize(b),y.forEach(i.default.deserialize)},undo:function(){y.map(i.default.findObjectBySerialized).forEach(function(e){return e.remove()}),a.default.findObjectBySerialized(b).remove(),m.forEach(i.default.deserialize),d.forEach(function(e){return n(e.name).setPosition(e.position)})},name:function(){return\"Insert layer : \"+t}}})}},freeGrabbedLayers:function(){window.uop()&&o.default.selection.clear()},grabAllLayers:function(){window.uop()&&o.default.selectAll()},popUpMenu:t.default.showContextMenu,zooming:function(e){var t=void 0;switch(e.key){case\"0\":t=100;break;case\"+\":this.values.canMoveNext&&(t=this.values.next);break;case\"-\":this.values.canMovePrev&&(t=this.values.prev)}window.uop()&&t&&this.$emit(\"zoom\",{name:\"Editor\",percentage:t})},zoomingByWheel:function(e){e.preventDefault(),e.stopPropagation();var t=e.wheelDelta<=-120&&this.values.canMovePrev?this.values.prev:e.wheelDelta>=120&&this.values.canMoveNext?this.values.next:void 0;t&&this.$emit(\"zoom\",{name:\"Editor\",percentage:t})}}}}(),module.exports.__esModule&&(module.exports=module.exports.default);var t=\"function\"==typeof module.exports?module.exports.options:module.exports;t.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",[n(\"network-tabs\",{on:{history:function(t){return e.$emit(\"history\",t)}}}),e._v(\" \"),n(\"network-action\",{attrs:{selection:e.selection,\"history-info\":e.historyInfo,\"zoom-percantages\":e.networkGraph.percentages,\"zoom-current-percentage\":e.networkGraph.percentage},on:{history:function(t){return e.$emit(\"history\",t)},zoom:function(t){return e.$emit(\"zoom\",t)}}}),e._v(\" \"),n(\"div\",{staticClass:\"tab-content network-editor-scroller\"},[n(\"svg\",{attrs:{id:\"network-editor\",tabindex:\"0\"},on:{keydown:[function(t){return(\"button\"in t||!e._k(t.keyCode,\"a\",void 0,t.key))&&t.ctrlKey?(t.preventDefault(),void e.grabAllLayers(t)):null},function(t){if(!t.altKey)return null;e.zooming(t)}],keyup:[function(t){if(!(\"button\"in t)&&e._k(t.keyCode,\"backspace\",void 0,t.key))return null;e.deleteLayerKeepingLinks(t)},function(t){if(!(\"button\"in t)&&e._k(t.keyCode,\"just-delete\",void 0,t.key))return null;e.deleteLayer(t)},function(t){if(!(\"button\"in t)&&e._k(t.keyCode,\"insert\",void 0,t.key))return null;e.insertLayer(t)},function(t){if(!(\"button\"in t)&&e._k(t.keyCode,\"esc\",27,t.key))return null;e.freeGrabbedLayers(t)}],mousewheel:function(t){if(!t.altKey)return null;e.zoomingByWheel(t)},dblclick:e.addLayer,mousedown:e.popUpMenu}},[n(\"clipPath\",{attrs:{id:e.layerTextClipId}},[n(\"rect\",{attrs:{x:0,y:0,width:e.layerTextClipWidth,height:e.layerTextClipHeight}})]),e._v(\" \"),n(\"defs\",[n(\"filter\",{attrs:{id:\"frameshadow\",filterUnits:\"userSpaceOnUse\"}},[n(\"feGaussianBlur\",{attrs:{result:\"blurOut\",stdDeviation:\"1\"}}),e._v(\" \"),n(\"feOffset\",{attrs:{result:\"offOut\",in:\"blurOut\"}}),e._v(\" \"),n(\"feBlend\",{attrs:{in:\"offOut\",mode:\"normal\"}})],1)])])])],1)},t.staticRenderFns=[];"},"hash":"37238dbaaf909a6248d7f29531b6f460","cacheData":{"env":{}}}